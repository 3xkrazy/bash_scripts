# NANDTOOL
#!/bin/bash

echo Which block device is your 3DS connected to?
echo [1] /dev/sdc
echo [2] /dev/sdd
echo [3] /dev/sde
echo [4] /dev/sdf
echo [5] /dev/sdg
echo -n "Select your choice: "
read CHOICE_1
case $CHOICE_1 in
        1)
                BLOCK_DEVICE=sdc
                ;;
        2)
                BLOCK_DEVICE=sdd
                ;;
        3)
                BLOCK_DEVICE=sde
                ;;
        4)
                BLOCK_DEVICE=sdf
                ;;
        5)
		BLOCK_DEVICE=sdg
                ;;
        *)
                echo Invalid choice!
                exit 1
		;;
esac

echo Your 3DS is connected at /dev/$BLOCK_DEVICE.

echo [1] Backup 3DS nand
echo [2] Write to 3DS nand
echo -n "Select your choice: "
read CHOICE_2
case $CHOICE_2 in
	1)
		echo -n "Enter nand backup name: "
		read NAND_NAME
		echo Backing up 3DS nand file: $NAND_NAME
		sudo dd if=/dev/$BLOCK_DEVICE of=$NAND_NAME bs=1M
		echo Backup completed! Calculating MD5 hash...
		md5sum $NAND_NAME
		;;
	2)
		echo -n "Enter nand backup name: "
		read NAND_NAME
                if [ ! -f $NAND_NAME ]; then
			echo $NAND_NAME does not exist!
			exit 1
		else
			echo Writing $NAND_NAME to 3DS nand...
			sudo dd if=$NAND_NAME of=/dev/$BLOCK_DEVICE bs=1M
			echo Write completed!
		fi
		;;
	*)
		echo Invalid choice!
		exit 1
		;;
esac
